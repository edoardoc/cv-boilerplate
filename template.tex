%!TEX TS-program = xelatex
%!TEX encoding = UTF-8 Unicode

\documentclass[$fontsize$, a4paper]{article}

% LAYOUT
%--------------------------------
% Margins
\usepackage{geometry}
\geometry{$geometry$}

% Do not indent paragraphs
\setlength\parindent{0in}

% Enable multicolumns
\usepackage{multicol}
\setlength{\columnsep}{-3.5cm}

% Suppress page numbers
\pagenumbering{gobble}

% Header & Footer
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\textbf{$name$}}
\fancyhead[R]{\small%
  $for(address)$$address$$sep$ 路 $endfor$%
  路 $phone$%
  $if(urls)$ 路 $for(urls)$\href{http://$urls$}{$urls$}$sep$ 路 $endfor$$endif$%
}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0.4pt}
\fancyfoot[C]{\scriptsize\textit{``Code is like humor. When you have to explain it, it's bad.''}}

% Language setup for XeLaTeX
%--------------------------------
\usepackage{polyglossia}
$if(lang)$
\setmainlanguage{$lang$}
$endif$

% TYPOGRAPHY
%--------------------------------
\usepackage{fontspec}
% \usepackage{xunicode}  % removed to avoid ucs/Greek encoding errors
% \usepackage{xltxtra} % removed: not present in pandoc/latex image
% converts LaTeX specials (quotes, dashes etc.) to Unicode
\defaultfontfeatures{Mapping=tex-text}
% Use the installed Raleway Medium font
\setmainfont[
  Path=/usr/share/fonts/truetype/raleway/,
  Extension=.ttf,
]{Raleway-Medium}
% (Removed SKILL CLOUD macros)

% MARGIN NOTES
%--------------------------------
\usepackage{marginnote}
\newcommand{\note}[1]{\marginnote{\scriptsize #1}}
\renewcommand*{\raggedleftmarginnote}{}
\reversemarginpar

% HEADINGS
%--------------------------------
\usepackage{sectsty}
% Removed ulem: not needed
% \usepackage[normalem]{ulem}  % removed: not needed
\sectionfont{\rmfamily\mdseries}
\subsectionfont{\rmfamily\mdseries\scshape\normalsize}
\subsubsectionfont{\rmfamily\bfseries\upshape\normalsize}

% PDF SETUP
%--------------------------------
\usepackage{hyperref}
\hypersetup
{
  pdfauthor={$name$},
  pdfsubject={$name$'s CV},
  pdftitle={$name$'s CV},
  colorlinks, breaklinks, xetex, bookmarks,
  filecolor=black,
  urlcolor=[rgb]{0.117,0.682,0.858},
  linkcolor=[rgb]{0.117,0.682,0.858},
  linkcolor=[rgb]{0.117,0.682,0.858},
  citecolor=[rgb]{0.117,0.682,0.858}
}
% removed external tagcloud package; using custom macro for skill cloud

% DOCUMENT
%--------------------------------
\begin{document}

{\LARGE $name$}\\[.2cm]

$if(urls)$
\begin{multicols}{2}
$endif$

$for(address)$
$address$\\
$endfor$

\vspace{-10pt}

$phone$\\
\href{mailto:$email$}{$email$}\\


$if(urls)$
\columnbreak

$for(urls)$
\href{http://$urls$}{$urls$}\\
$endfor$
\end{multicols}
$endif$

\vspace{30pt}

% optional spoken languages section
$if(spoken_languages)$
\section*{Spoken Languages}
\noindent
$for(spoken_languages)$$spoken_languages$$sep$, $endfor$
\vspace{20pt}
$endif$

\section*{Technical Skills}
\noindent
\textbf{Languages:} $for(skills.languages)$$skills.languages$$sep$, $endfor$\\[6pt]
\textbf{Frameworks:} $for(skills.frameworks)$$skills.frameworks$$sep$, $endfor$\\[6pt]
\textbf{Databases:} $for(skills.databases)$$skills.databases$$sep$, $endfor$\\[6pt]
\textbf{APIs:} $for(skills.apis)$$skills.apis$$sep$, $endfor$\\[6pt]
\textbf{Tools:} $for(skills.tools)$$skills.tools$$sep$, $endfor$\\[6pt]
\textbf{Platforms:} $for(skills.platforms)$$skills.platforms$$sep$, $endfor$

% \vfill

\vspace{25pt}

\section*{Experience}
\noindent
$for(experience)$
\note{$experience.years$}\textsc{$experience.employer$}\\
  \emph{$experience.job$}\\
  $for(experience.description)$
    $experience.description$\\
  $endfor$\\[.2cm]
$endfor$

$if(education)$
\section*{Education}
\noindent
$for(education)$
  \textbf{$education.year$}\quad \textbf{$education.subject$}$if(education.degree)$, $education.degree$$endif$\\
  \emph{$education.institute$}$if(education.city)$, $education.city$$endif$\\[.2cm]
$endfor$
$endif$


\end{document}
